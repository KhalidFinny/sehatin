<shared-sidebar *ngIf="isSidebarOpen" userType="user" />
<shared-header title="Skrining PTM" />

<!-- prettier-ignore -->
<main [ngClass]="isSidebarOpen ? 'ml-64' : 'ml-8'" class="cursor-default border-b border-gray-100 py-8 pr-8 transition-all duration-300 ease-in-out">
  <!-- Intro Card -->
  <figure *ngIf="!showQuestions && !showResult" class="mt-24 mb-8 flex items-center justify-center gap-12 rounded-2xl border border-gray-100 bg-white px-8 py-10">
    <img src="/icons/doctor.png" alt="Dokter SEHATIN" class="doctor-image h-80 w-auto" />
    <figcaption>
      <h1 class="mb-4 text-xl font-bold text-gray-900 lg:text-3xl">
        Yuk cek kondisi kamu <span class="text-[#2c9ab7]">sekarang</span>!
      </h1>
      <p class="mb-8 text-sm leading-8 text-gray-600 lg:text-lg">
        Pastikan untuk menjawab semua pertanyaan dengan jujur ya agar kami dapat
        memberikan hasilnya pada Anda!
      </p>
      <button (click)="startScreening()" class="btn-primary cursor-pointer rounded-lg bg-[#2c9ab7] px-8 py-3.5 text-sm font-semibold text-white transition-colors duration-200 hover:bg-[#26798f]">
        Mulai Skrining <i class="fa-solid fa-arrow-right ml-2"></i>
      </button>
    </figcaption>
  </figure>

  <!-- Questions Cards -->
  <section *ngIf="showQuestions && !showResult" class="space-y-6">
    <!-- Progress Bar -->
    <figure class="mt-24 rounded-2xl border border-gray-100 bg-white p-6">
      <figcaption class="mb-4 flex items-center justify-between">
        <h2 class="text-xl font-semibold text-gray-900">
          Riwayat dan Faktor Risiko PTM
        </h2>
        <h5 class="text-sm text-gray-600">
          {{ currentQuestionIndex + 1 }} / {{ questions.length }}
        </h5>
      </figcaption>
      <div class="h-2 w-full rounded-full bg-gray-200">
        <div class="h-2 rounded-full bg-[#2c9ab7] transition-all duration-300" [style.width.%]="((currentQuestionIndex + 1) / questions.length) * 100"></div>
      </div>
    </figure>

    <!-- Question Card -->
    <figure class="question-card flex items-start gap-12 rounded-2xl border border-gray-100 bg-white p-8">
      <img src="/icons/doctor.png" alt="Dokter SEHATIN" class="doctor-image h-80 w-auto" />
      <figcaption class="flex-1">
        <!-- Category Title -->
        <h4 class="mb-2 text-sm font-semibold tracking-wide text-[#2c9ab7] uppercase">
          {{ getCategoryTitle(questions[currentQuestionIndex].category) }}
        </h4>
        <h3 class="mb-6 text-2xl leading-relaxed font-semibold text-gray-900">
          {{ questions[currentQuestionIndex].question }}
        </h3>
        <span class="grid grid-cols-2 gap-6">
          <button
            (click)="selectAnswer('ya')"
            [class]="'rounded-lg border-2 p-6 text-lg font-semibold transition-all duration-200 ' + (selectedAnswer === 'ya' ? 'border-[#2c9ab7] bg-[#2c9ab7] text-white' : 'border-gray-300 bg-white text-gray-700 hover:border-[#2c9ab7]')">
            Ya, saya mengalami hal tersebut
          </button>
          <button (click)="selectAnswer('tidak')" [class]="'rounded-lg border-2 p-6 text-lg font-semibold transition-all duration-200 ' + (selectedAnswer === 'tidak' ? 'border-[#2c9ab7] bg-[#2c9ab7] text-white' : 'border-gray-300 bg-white text-gray-700 hover:border-[#2c9ab7]')">
            Tidak, saya tidak mengalami hal tersebut
          </button>
        </span>
      </figcaption>
    </figure>
  </section>

  <!-- Result Card -->
  <section *ngIf="showResult" class="result-fade-in mt-24 rounded-2xl border border-gray-100 bg-white p-8">
    <h2 class="mb-4 text-center text-3xl font-bold text-gray-900">
      Hasil Skrining PTM
    </h2>
    <p class="mb-8 text-center text-lg text-gray-600">
      Berdasarkan jawaban Anda, berikut adalah analisis risiko kesehatan
    </p>

    <!-- Risk Categories -->
    <article class="mb-8 grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-5">
      <!-- Hipertensi -->
      <figure class="risk-card rounded-xl border-2 border-red-200 bg-red-50 p-6 text-center">
        <i class="fa-solid fa-heart-pulse mx-auto mb-4 rounded-full bg-red-500 p-4 text-xl text-white"></i>
        <h3 class="mb-2 text-lg font-bold text-red-800">Hipertensi</h3>
        <h5 class="mb-2 text-2xl font-bold text-red-600">TINGGI</h5>
        <div class="h-2 w-full rounded-full bg-red-200">
          <div class="h-2 rounded-full bg-red-500" style="width: 85%"></div>
        </div>
      </figure>

      <!-- Diabetes -->
      <figure class="risk-card rounded-xl border-2 border-yellow-200 bg-yellow-50 p-6 text-center">
        <i class="fa-solid fa-cookie-bite mx-auto mb-4 rounded-full bg-yellow-500 p-4 text-xl text-white"></i>
        <h3 class="mb-2 text-lg font-bold text-yellow-800">Diabetes</h3>
        <h5 class="mb-2 text-2xl font-bold text-yellow-600">SEDANG</h5>
        <div class="h-2 w-full rounded-full bg-yellow-200">
          <div class="h-2 rounded-full bg-yellow-500" style="width: 60%"></div>
        </div>
      </figure>

      <!-- Obesitas -->
      <figure class="risk-card rounded-xl border-2 border-orange-200 bg-orange-50 p-6 text-center">
        <i class="fa-solid fa-weight-scale mx-auto mb-4 rounded-full bg-orange-500 p-4 text-xl text-white"></i>
        <h3 class="mb-2 text-lg font-bold text-orange-800">Obesitas</h3>
        <h5 class="mb-2 text-2xl font-bold text-orange-600">RENDAH</h5>
        <div class="h-2 w-full rounded-full bg-orange-200">
          <div class="h-2 rounded-full bg-orange-500" style="width: 30%"></div>
        </div>
      </figure>

      <!-- Kardiovaskular -->
      <figure class="risk-card rounded-xl border-2 border-purple-200 bg-purple-50 p-6 text-center">
        <i class="fa-solid fa-heart mx-auto mb-4 rounded-full bg-purple-500 p-4 text-xl text-white"></i>
        <h3 class="mb-2 text-lg font-bold text-purple-800">Kardiovaskular</h3>
        <h5 class="mb-2 text-2xl font-bold text-purple-600">SEDANG</h5>
        <div class="h-2 w-full rounded-full bg-purple-200">
          <div class="h-2 rounded-full bg-purple-500" style="width: 55%"></div>
        </div>
      </figure>

      <!-- Kolesterol -->
      <figure class="risk-card rounded-xl border-2 border-indigo-200 bg-indigo-50 p-6 text-center">
        <i class="fa-solid fa-chart-line mx-auto mb-4 rounded-full bg-indigo-500 p-4 text-xl text-white"></i>
        <h3 class="mb-2 text-lg font-bold text-indigo-800">Kolesterol</h3>
        <div class="mb-2 text-2xl font-bold text-indigo-600">RENDAH</div>
        <div class="h-2 w-full rounded-full bg-indigo-200">
          <div class="h-2 rounded-full bg-indigo-500" style="width: 25%"></div>
        </div>
      </figure>
    </article>

    <!-- Main Risk Alert -->
    <figure class="alert-pulse mb-8 flex items-center gap-4 rounded-xl border-2 border-red-300 bg-gradient-to-r from-red-50 to-red-100 p-6">
      <i class="fa-solid fa-exclamation-triangle rounded-full bg-red-500 p-3 text-lg text-white"></i>
      <figcaption>
        <h3 class="mb-2 text-xl font-bold text-red-800">⚠️ Perhatian Khusus</h3>
        <p class="text-red-700">
          Anda memiliki risiko <strong>HIPERTENSI TINGGI</strong> berdasarkan
          pola hidup yang terdeteksi
        </p>
      </figcaption>
    </figure>

    <!-- Quick Actions -->
    <article class="mb-8 grid grid-cols-1 gap-4 md:grid-cols-3">
      <figure class="rounded-lg border border-blue-200 bg-blue-50 p-4 text-center">
        <i class="fa-solid fa-stethoscope mb-2 text-2xl text-[#2c9ab7]"></i>
        <h4 class="mb-1 font-semibold text-[#2c9ab7]">Konsultasi Dokter</h4>
        <p class="text-sm text-blue-700">Segera periksa tekanan darah</p>
      </figure>
      <figure class="rounded-lg border border-green-200 bg-green-50 p-4 text-center">
        <i class="fa-solid fa-dumbbell mb-2 text-2xl text-green-600"></i>
        <h4 class="mb-1 font-semibold text-green-800">Olahraga Rutin</h4>
        <p class="text-sm text-green-700">30 menit sehari, 5x seminggu</p>
      </figure>
      <figure class="rounded-lg border border-yellow-200 bg-yellow-50 p-4 text-center">
        <i class="fa-solid fa-apple-alt mb-2 text-2xl text-yellow-600"></i>
        <h4 class="mb-1 font-semibold text-yellow-800">Diet Sehat</h4>
        <p class="text-sm text-yellow-700">Kurangi garam & lemak</p>
      </figure>
    </article>

    <!-- Action Buttons -->
    <span class="flex flex-col justify-center gap-4 sm:flex-row">
      <button
        (click)="resetScreening()"
        class="rounded-lg bg-[#2c9ab7] px-8 py-3 font-semibold text-white transition-colors duration-200 hover:bg-[#26798f]"
      >
        <i class="fa-solid fa-redo mr-2"></i>
        Ulangi Skrining
      </button>
      <button
        (click)="downloadPDF()"
        class="rounded-lg bg-green-600 px-8 py-3 font-semibold text-white transition-colors duration-200 hover:bg-green-700"
      >
        <i class="fa-solid fa-download mr-2"></i>
        Download PDF
      </button>
      <button
        class="rounded-lg bg-purple-600 px-8 py-3 font-semibold text-white transition-colors duration-200 hover:bg-purple-700"
      >
        <i class="fa-solid fa-calendar-check mr-2"></i>
        Jadwalkan Konsultasi
      </button>
    </span>
  </section>
</main>